window.wp=window.wp||{};(function(g){var a,q,b,h,e,k=360,l,c,i="standard",n="short-format",p=["status","aside"],m=["standard","chat","status","aside","gallery"],f=g(".icon32");function d(r){a.get(0).className=a.get(0).className.replace(/\s?\bwp-format-[^ ]+/g,"");a.addClass("wp-format-"+r);f.get(0).className=f.get(0).className.replace(/\s?\bwp-format-[^ ]+/g,"");f.addClass("wp-format-"+r)}function o(t,s){var r;l=g("#content, #content_ifr");r=l.height();if(120<r){k=r}if(-1<g.inArray(t,p)){if(!l.hasClass(n)){l.addClass(n);if(s){l.each(function(){g(this).css({height:120})})}else{l.each(function(){g(this).animate({height:120})})}}}else{l.removeClass(n).animate({height:k})}}function j(x){var t,r,s=x.parent(),w=x.data("wp-format"),u=g(".post-format-description"),v=g("#title");if(typeof a==="undefined"){a=g("#post-body-content")}s.slideUp().find("a.active").removeClass("active");x.addClass("active");g("#post_format").val(w);g(".post-format-change").show().find("span.icon").removeClass(postFormats.currentPostFormat).addClass(w);if(-1<g.inArray(w,m)){d(w);q.hide()}else{q.slideUp(200,function(){d(w);q.slideDown(400)})}o(w);v.focus();if(""===v.val()){g("#title-prompt-text").removeClass("screen-reader-text")}u.html(x.data("description"));if(u.not(":visible")){u.slideDown("fast")}if(typeof tinymce!="undefined"){t=tinymce.get("content");if(t){r=t.getBody();r.className=r.className.replace(/\bpost-format-[^ ]+/,"");t.dom.addClass(r,"post-format-"+w)}}c.toggleClass("gallery","gallery"===w);postFormats.currentPostFormat=w}g(function(){c=g("#insert-media-button").toggleClass("gallery","gallery"===postFormats.currentPostFormat);q=g(".post-formats-fields");i=g(".post-format-options .active").data("wp-format");if(-1<g.inArray(i,p)){o(i,true)}g(".post-format-change a").click(function(){g(".post-formats-fields, .post-format-change").slideUp();g(".post-format-options").slideDown();return false});g(".post-format-options").on("click","a",function(r){r.preventDefault();j(g(this))});g(".wp-format-media-select").click(function(t){t.preventDefault();var r=g(this),v="image",u=r.closest(".wp-format-media-holder"),s=g("#wp_format_"+u.data("format"));v=u.data("format");if(b&&h===v){b.open();return}h=v;b=wp.media.frames.formatMedia=wp.media({button:{text:r.data("update")},states:[new wp.media.controller.Library({library:wp.media.query({type:v}),title:r.data("choose"),displaySettings:"image"===v})]});e=function(D){var x,z,A="",y=D.url,B=D.mime,C=D.type;if("video"===C){if(D.width){x=D.width;if(x>600){x=600}A+=' width="'+x+'"'}if(D.height){z=D.height;if(D.width&&x<D.width){z=Math.round((z*x)/D.width)}A+=' height="'+z+'"'}}g("#"+C+"-preview").remove();u.parent().prepend('<div id="'+C+'-preview" class="wp-format-media-preview"><'+C+A+' class="wp-'+C+'-shortcode" controls="controls" preload="none"><source type="'+B+'" src="'+y+'" /></'+C+"></div>");g(".wp-"+C+"-shortcode").mediaelementplayer()};b.on("select",function(){var x=0,z=0,y,A=b.state().get("selection").first().toJSON();if(0===A.mime.indexOf("audio")){s.val(A.url);e(A)}else{if(0===A.mime.indexOf("video")){A.src=A.url;s.val(wp.shortcode.string({tag:"video",attrs:_.pick(A,"src","width","height")}));e(A)}else{y=wp.media.string.image({align:getUserSetting("align"),size:getUserSetting("imgsize"),link:getUserSetting("urlbutton")},A);s.val(y);g("#image-preview").remove();if(A.width){x=A.width>600?600:A.width}if(A.height){z=A.height}if(x<A.width){z=Math.round((z*x)/A.width)}u.parent().prepend(['<div id="image-preview" class="wp-format-media-preview">','<img src="',A.url,'"',x?' width="'+x+'"':"",z?' height="'+z+'"':""," />","</div>"].join(""))}}});b.open()})})})(jQuery);