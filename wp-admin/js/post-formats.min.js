window.wp=window.wp||{};(function(e){var a,b,f,d,h=["standard","chat","status","aside","gallery"],i=e(".post-formats-fields");function c(j){a.get(0).className=a.get(0).className.replace(/\bwp-format-[^ ]+/g,"");a.addClass("wp-format-"+j)}function g(p){var l,j,k=p.parent(),o=p.data("wp-format"),m=e(".post-format-description"),n=e("#title");if(typeof a==="undefined"){a=e("#post-body-content")}k.slideUp().find("a.active").removeClass("active");p.addClass("active");e("#post_format").val(o);e(".post-format-change").show().find("span.icon").removeClass(postFormats.currentPostFormat).addClass(o);if(-1<e.inArray(o,h)){c(o);i.hide()}else{i.slideUp(200,function(){c(o);i.slideDown(400)})}n.focus();if(""===n.val()){e("#title-prompt-text").removeClass("screen-reader-text")}m.html(p.data("description"));if(m.not(":visible")){m.slideDown("fast")}if(typeof tinymce!="undefined"){l=tinymce.get("content");if(l){j=l.getBody();j.className=j.className.replace(/\bpost-format-[^ ]+/,"");l.dom.addClass(j,"post-format-"+o)}}postFormats.currentPostFormat=o}e(function(){e(".post-format-change a").click(function(){e(".post-formats-fields, .post-format-change").slideUp();e(".post-format-options").slideDown();return false});e(".post-format-options").on("click","a",function(j){j.preventDefault();g(e(this))});e(".wp-format-media-select").click(function(l){l.preventDefault();var j=e(this),n="image",m=j.closest(".wp-format-media-holder"),k=e("#wp_format_"+m.data("format"));n=m.data("format");if(b&&f===n){b.open();return}f=n;b=wp.media.frames.formatMedia=wp.media({title:j.data("choose"),library:{type:n},button:{text:j.data("update")}});d=function(u){var o,q,r="",p=u.url,s=u.mime,t=u.type;if("video"===t){if(u.width){o=u.width;if(o>600){o=600}r+=' width="'+o+'"'}if(u.height){q=u.height;if(u.width&&o<u.width){q=Math.round((q*o)/u.width)}r+=' height="'+q+'"'}}e("#"+t+"-preview").remove();m.parent().prepend('<div id="'+t+'-preview" class="wp-format-media-preview"><'+t+r+' class="wp-'+t+'-shortcode" controls="controls" preload="none"><source type="'+s+'" src="'+p+'" /></'+t+"></div>");e(".wp-"+t+"-shortcode").mediaelementplayer()};b.on("select",function(){var o=0,q=0,p,r=b.state().get("selection").first().toJSON();if(0===r.mime.indexOf("audio")){k.val(r.url);d(r)}else{if(0===r.mime.indexOf("video")){r.src=r.url;k.val(wp.shortcode.string({tag:"video",attrs:_.pick(r,"src","width","height")}));d(r)}else{p=wp.media.string.image({},r);k.val(p);e("#image-preview").remove();if(r.width){o=r.width>600?600:r.width}if(r.height){q=r.height}if(o<r.width){q=Math.round((q*o)/r.width)}m.parent().prepend(['<div id="image-preview" class="wp-format-media-preview">','<img src="',r.url,'"',o?' width="'+o+'"':"",q?' height="'+q+'"':""," />","</div>"].join(""))}}});b.open()})})})(jQuery);