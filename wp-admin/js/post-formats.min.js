window.wp=window.wp||{};(function(f){var a,p,b,g,d,j=360,k,h="standard",m="short-format",o=["status","aside"],l=["standard","chat","status","aside","gallery"],e=f(".icon32");function c(q){a.get(0).className=a.get(0).className.replace(/\s?\bwp-format-[^ ]+/g,"");a.addClass("wp-format-"+q);e.get(0).className=e.get(0).className.replace(/\s?\bwp-format-[^ ]+/g,"");e.addClass("wp-format-"+q)}function n(s,r){var q;k=f("#content, #content_ifr");q=k.height();if(120<q){j=q}if(-1<f.inArray(s,o)){if(!k.hasClass(m)){k.addClass(m);if(r){k.each(function(){f(this).css({height:120})})}else{k.each(function(){f(this).animate({height:120})})}}}else{k.removeClass(m).animate({height:j})}}function i(w){var s,q,r=w.parent(),v=w.data("wp-format"),t=f(".post-format-description"),u=f("#title");if(typeof a==="undefined"){a=f("#post-body-content")}r.slideUp().find("a.active").removeClass("active");w.addClass("active");f("#post_format").val(v);f(".post-format-change").show().find("span.icon").removeClass(postFormats.currentPostFormat).addClass(v);if(-1<f.inArray(v,l)){c(v);p.hide()}else{p.slideUp(200,function(){c(v);p.slideDown(400)})}n(v);u.focus();if(""===u.val()){f("#title-prompt-text").removeClass("screen-reader-text")}t.html(w.data("description"));if(t.not(":visible")){t.slideDown("fast")}if(typeof tinymce!="undefined"){s=tinymce.get("content");if(s){q=s.getBody();q.className=q.className.replace(/\bpost-format-[^ ]+/,"");s.dom.addClass(q,"post-format-"+v)}}postFormats.currentPostFormat=v}f(function(){p=f(".post-formats-fields");h=f(".post-format-options .active").data("wp-format");if(-1<f.inArray(h,o)){n(h,true)}f(".post-format-change a").click(function(){f(".post-formats-fields, .post-format-change").slideUp();f(".post-format-options").slideDown();return false});f(".post-format-options").on("click","a",function(q){q.preventDefault();i(f(this))});f(".wp-format-media-select").click(function(s){s.preventDefault();var q=f(this),u="image",t=q.closest(".wp-format-media-holder"),r=f("#wp_format_"+t.data("format"));u=t.data("format");if(b&&g===u){b.open();return}g=u;b=wp.media.frames.formatMedia=wp.media({button:{text:q.data("update")},states:[new wp.media.controller.Library({library:wp.media.query({type:u}),title:q.data("choose"),displaySettings:"image"===u})]});d=function(C){var v,y,z="",x=C.url,A=C.mime,B=C.type;if("video"===B){if(C.width){v=C.width;if(v>600){v=600}z+=' width="'+v+'"'}if(C.height){y=C.height;if(C.width&&v<C.width){y=Math.round((y*v)/C.width)}z+=' height="'+y+'"'}}f("#"+B+"-preview").remove();t.parent().prepend('<div id="'+B+'-preview" class="wp-format-media-preview"><'+B+z+' class="wp-'+B+'-shortcode" controls="controls" preload="none"><source type="'+A+'" src="'+x+'" /></'+B+"></div>");f(".wp-"+B+"-shortcode").mediaelementplayer()};b.on("select",function(){var v=0,y=0,x,z=b.state().get("selection").first().toJSON();if(0===z.mime.indexOf("audio")){r.val(z.url);d(z)}else{if(0===z.mime.indexOf("video")){z.src=z.url;r.val(wp.shortcode.string({tag:"video",attrs:_.pick(z,"src","width","height")}));d(z)}else{x=wp.media.string.image({align:getUserSetting("align"),size:getUserSetting("imgsize"),link:getUserSetting("urlbutton")},z);r.val(x);f("#image-preview").remove();if(z.width){v=z.width>600?600:z.width}if(z.height){y=z.height}if(v<z.width){y=Math.round((y*v)/z.width)}t.parent().prepend(['<div id="image-preview" class="wp-format-media-preview">','<img src="',z.url,'"',v?' width="'+v+'"':"",y?' height="'+y+'"':""," />","</div>"].join(""))}}});b.open()})})})(jQuery);