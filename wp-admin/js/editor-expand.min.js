window.wp=window.wp||{},jQuery(document).ready(function(a){function b(){var a=m.width();T={windowHeight:m.height(),windowWidth:a,adminBarHeight:a>600?o.outerHeight():0,toolsHeight:s.outerHeight()||0,menuBarHeight:z.outerHeight()||0,visualTopHeight:t.outerHeight()||0,textTopHeight:v.outerHeight()||0,bottomHeight:y.outerHeight()||0,statusBarHeight:A.outerHeight()||0,sideSortablesHeight:B.height()||0},T.menuBarHeight<3&&(T.menuBarHeight=0)}function c(a){var b,c,d,e,f,g=jQuery.ui.keyCode,h=a.keyCode,i=document.createRange(),j=w[0].selectionStart,k=w[0].selectionEnd,l=x[0].firstChild,m=10;if(!j||!k||j===k){try{i.setStart(l,j),i.setEnd(l,k+1)}catch(n){}b=i.getBoundingClientRect(),b.height&&(c=b.top-m,d=c+b.height+m,e=T.adminBarHeight+T.toolsHeight+T.textTopHeight,f=T.windowHeight-T.bottomHeight,e>c&&(h===g.UP||h===g.LEFT||h===g.BACKSPACE)?window.scrollTo(window.pageXOffset,c+window.pageYOffset-e):d>f&&window.scrollTo(window.pageXOffset,d+window.pageYOffset-f))}}function d(){if(!(k&&!k.isHidden()||!k&&"tinymce"===S)){var a,b=w.height();x.width(w.width()-22),x.text(w.val()+"&nbsp;"),a=x.height(),R>a&&(a=R),a!==b&&(w.height(a),e())}}function e(a){if(!E||!E.settings.visible){var c,e,f,g,h,i,j,l,o,q=m.scrollTop(),F="scroll"!==a,G=k&&!k.isHidden(),M=R,N=D.offset().top,O=1,S=r.width();(F||!T.windowHeight)&&b(),G||"resize"!==a||d(),G?(c=t,e=u,j=T.visualTopHeight):(c=v,e=w,j=T.textTopHeight),i=c.parent().offset().top,l=e.offset().top,o=e.outerHeight(),h=G?R+j:R+20,h=o>h+5,h?((!H||F)&&q>=i-T.toolsHeight-T.adminBarHeight&&q<=i-T.toolsHeight-T.adminBarHeight+o-M?(H=!0,s.css({position:"fixed",top:T.adminBarHeight,width:S}),G&&z.length&&z.css({position:"fixed",top:T.adminBarHeight+T.toolsHeight,width:S-2*O-(G?0:c.outerWidth()-c.width())}),c.css({position:"fixed",top:T.adminBarHeight+T.toolsHeight+T.menuBarHeight,width:S-2*O-(G?0:c.outerWidth()-c.width())})):(H||F)&&(q<=i-T.toolsHeight-T.adminBarHeight?(H=!1,s.css({position:"absolute",top:0,width:S}),G&&z.length&&z.css({position:"absolute",top:0,width:S-2*O}),c.css({position:"absolute",top:T.menuBarHeight,width:S-2*O-(G?0:c.outerWidth()-c.width())})):q>=i-T.toolsHeight-T.adminBarHeight+o-M&&(H=!1,s.css({position:"absolute",top:o-M,width:S}),G&&z.length&&z.css({position:"absolute",top:o-M,width:S-2*O}),c.css({position:"absolute",top:o-M+T.menuBarHeight,width:S-2*O-(G?0:c.outerWidth()-c.width())}))),(!I||F)&&q+T.windowHeight<=l+o+T.bottomHeight+T.statusBarHeight+O?(I=!0,A.css({position:"fixed",bottom:T.bottomHeight,width:S-2*O}),y.css({position:"fixed",bottom:0,width:S})):(I||F)&&q+T.windowHeight>l+o+T.bottomHeight+T.statusBarHeight-O&&(I=!1,A.add(y).attr("style",""))):F&&(s.css({position:"absolute",top:0,width:S}),G&&z.length&&z.css({position:"absolute",top:0,width:S-2*O}),c.css({position:"absolute",top:T.menuBarHeight,width:S-2*O-(G?0:c.outerWidth()-c.width())}),A.add(y).attr("style","")),C.width()<300&&T.windowWidth>600&&n.height()>B.height()+N+120&&T.windowHeight<o?(T.sideSortablesHeight+P+Q>T.windowHeight||J||K?N>=q+P?(B.attr("style",""),J=K=!1):q>L?J?(J=!1,f=B.offset().top-T.adminBarHeight,g=p.offset().top,g<f+T.sideSortablesHeight+Q&&(f=g-T.sideSortablesHeight-12),B.css({position:"absolute",top:f,bottom:""})):!K&&T.sideSortablesHeight+B.offset().top+Q<q+T.windowHeight&&(K=!0,B.css({position:"fixed",top:"auto",bottom:Q})):L>q&&(K?(K=!1,f=B.offset().top-Q,g=p.offset().top,g<f+T.sideSortablesHeight+Q&&(f=g-T.sideSortablesHeight-12),B.css({position:"absolute",top:f,bottom:""})):!J&&B.offset().top>=q+P&&(J=!0,B.css({position:"fixed",top:P,bottom:""}))):(q>=N-P?B.css({position:"fixed",top:P}):B.attr("style",""),J=K=!1),L=q):(B.attr("style",""),J=K=!1),F&&(r.css({paddingTop:T.toolsHeight}),G?u.css({paddingTop:T.visualTopHeight+T.menuBarHeight}):(w.css({marginTop:T.textTopHeight}),x.width(S-20-2*O)))}}function f(){d(),e()}function g(a){for(var b=1;6>b;b++)setTimeout(a,500*b)}function h(){clearTimeout(l),l=setTimeout(e,100)}function i(){window.pageYOffset&&window.pageYOffset>O&&window.scrollTo(window.pageXOffset,0),q.addClass("wp-editor-expand"),m.on("scroll.editor-expand resize.editor-expand",function(a){e(a.type),h()}),n.on("wp-collapse-menu.editor-expand postboxes-columnchange.editor-expand editor-classchange.editor-expand",e).on("postbox-toggled.editor-expand",function(){!J&&!K&&window.pageYOffset>P&&(K=!0,window.scrollBy(0,-1),e(),window.scrollBy(0,1)),e()}),w.on("focus.editor-expand input.editor-expand propertychange.editor-expand",d),w.on("keyup.editor-expand",c),F(),E&&E.pubsub.subscribe("hidden",f),k&&(k.settings.wp_autoresize_on=!0,k.execCommand("wpAutoResizeOn"),k.isHidden()||k.execCommand("wpAutoResize")),(!k||k.isHidden())&&d(),e()}function j(){var b=window.getUserSetting("ed_size");window.pageYOffset&&window.pageYOffset>O&&window.scrollTo(window.pageXOffset,0),q.removeClass("wp-editor-expand"),m.off(".editor-expand"),n.off(".editor-expand"),w.off(".editor-expand"),G(),E&&E.pubsub.unsubscribe("hidden",f),a.each([t,v,s,z,y,A,r,u,w,B],function(a,b){b&&b.attr("style","")}),H=I=J=K=!1,k&&(k.settings.wp_autoresize_on=!1,k.execCommand("wpAutoResizeOff"),k.isHidden()||(w.hide(),b&&k.theme.resizeTo(null,b))),b&&w.height(b)}var k,l,m=a(window),n=a(document),o=a("#wpadminbar"),p=a("#wpfooter"),q=a("#postdivrich"),r=a("#wp-content-wrap"),s=a("#wp-content-editor-tools"),t=a(),u=a(),v=a("#ed_toolbar"),w=a("#content"),x=a('<div id="content-textarea-clone"></div>'),y=a("#post-status-info"),z=a(),A=a(),B=a("#side-sortables"),C=a("#postbox-container-1"),D=a("#post-body"),E=window.wp.editor&&window.wp.editor.fullscreen,F=function(){},G=function(){},H=!1,I=!1,J=!1,K=!1,L=0,M=0,N=0,O=130,P=56,Q=20,R=300,S=window.getUserSetting("editor"),T={windowHeight:0,windowWidth:0,adminBarHeight:0,toolsHeight:0,menuBarHeight:0,visualTopHeight:0,textTopHeight:0,bottomHeight:0,statusBarHeight:0,sideSortablesHeight:0};x.insertAfter(w),x.css({"font-family":w.css("font-family"),"font-size":w.css("font-size"),"line-height":w.css("line-height"),"white-space":"pre-wrap","word-wrap":"break-word"}),n.on("tinymce-editor-init.editor-expand",function(a,b){function c(){var a,c,d=b.selection.getNode();return c=b.plugins.wpview&&(a=b.plugins.wpview.getView(d))?a.getBoundingClientRect():d.getBoundingClientRect(),c.height?c:!1}function f(a){var d,e,f,g,h=tinymce.util.VK,i=a.keyCode,j=c(),k=10;j&&(47>=i&&i!==h.SPACEBAR&&i!==h.ENTER&&i!==h.DELETE&&i!==h.BACKSPACE&&i!==h.UP&&i!==h.LEFT&&i!==h.DOWN&&i!==h.UP||i>=91&&93>=i||i>=112&&123>=i||144===i||145===i||(d=j.top+b.iframeElement.getBoundingClientRect().top,e=d+j.height,d-=k,e+=k,f=T.adminBarHeight+T.toolsHeight+T.menuBarHeight+T.visualTopHeight,g=T.windowHeight-T.bottomHeight-T.statusBarHeight,g-f<j.height||(f>d&&(i===h.UP||i===h.LEFT||i===h.BACKSPACE)?window.scrollTo(window.pageXOffset,d+window.pageYOffset-f):e>g&&window.scrollTo(window.pageXOffset,e+window.pageYOffset-g))))}function h(){N=window.pageYOffset,setTimeout(function(){var a=r.offset().top;(window.pageYOffset>a||M)&&window.scrollTo(window.pageXOffset,M?M:a-T.adminBarHeight),b.execCommand("wpAutoResize"),e()},300),e()}function i(){M=window.pageYOffset,setTimeout(function(){var a=r.offset().top;(window.pageYOffset>a||N)&&window.scrollTo(window.pageXOffset,N?N:a-T.adminBarHeight),d(),e()},100),e()}"content"===b.id&&(k=b,b.settings.autoresize_min_height=R,t=r.find(".mce-toolbar-grp"),u=r.find(".mce-edit-area"),A=r.find(".mce-statusbar"),z=r.find(".mce-menubar"),F=function(){b.on("keyup",f),b.on("show",h),b.on("hide",i),b.on("setcontent wp-autoresize wp-toolbar-toggle",e)},G=function(){b.off("keyup",f),b.off("show",h),b.off("hide",i),b.off("setcontent wp-autoresize wp-toolbar-toggle",e)},q.hasClass("wp-editor-expand")&&(F(),g(e)))}),q.hasClass("wp-editor-expand")&&(i(),r.hasClass("html-active")&&g(function(){e(),d()})),a("#adv-settings .editor-expand").show(),a("#editor-expand-toggle").on("change.editor-expand",function(){a(this).prop("checked")?(i(),window.setUserSetting("editor_expand","on")):(j(),window.setUserSetting("editor_expand","off"))}),window.editorExpand={on:i,off:j}});